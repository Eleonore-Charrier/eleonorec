<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Functions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">OPERATING PROCEDURE R: SUNBURST VISUALIZATION OF THE CLASSIFICATION</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">INTRODUCTION</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    WALKTHROUGH
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="files.html">Files Needed</a>
    </li>
    <li>
      <a href="packages.html">Packages</a>
    </li>
    <li>
      <a href="path.html">Setting Path to Samples</a>
    </li>
    <li>
      <a href="colors.html">Colors</a>
    </li>
    <li>
      <a href="functions.html">Functions</a>
    </li>
    <li>
      <a href="sunburst.html">Sunburst Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="variablestochange.html">VARIABLES TO BE CHANGED</a>
</li>
<li>
  <a href="links.html">LINKS</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Functions</h1>

</div>


<p>This step will allow the creation of custom functions which will be later of use for the construction of sunburst plot. We are creating these custom functions as a way to simplify our code as well as a way to make it more understandable. Those custom functions will also allow the user to have a code frame where only their data input will be changed. This will make the code more stable and reliable.</p>
<p>The first custom function will render possible the gathering of column of interest from the mother file of choice. This function will allow the user to replace both of those by: attributing the column of interest to “To_Replace” and the mother dataframe of choice to “Data_Of_Choice”. This function use the <code>gather()</code> function to collect a set of wanted column names and places them into a single “key” column. We use this function twice. A first time, to gather the column samples of choice into a single column called “Taxonomy_Value”, and a second time to gather the number of reads per “Taxonomy_Value”. We then use the <code>group_by()</code> to group our two columns by the “Taxonomy_Value” column. Finally, the <code>summarise()</code> on the grouped data previously created by the <code>group_by()</code> function. This function applied to the number of reads per species will create one row for each “Taxonomy_Value”. If ordered into a new object, this function will create a new data frame containing only the number of reads per taxonomy_value (species).</p>
<pre class="r numberLines"><code>Function_Gather &lt;-function(To_Replace, Data_Of_Choice) {
 To_Replace &lt;- enquo(To_Replace)
   Data_Of_Choice %&gt;% 
  gather(key = &quot;Sample&quot;, value = &quot;Read&quot;, !!To_Replace) %&gt;%
    gather(key = &quot;taxonomy&quot;, value = &quot;Taxonomy_Value&quot;, order:species) %&gt;%
      group_by(Taxonomy_Value) %&gt;%
        summarise(Total = sum(Read))
}</code></pre>
<p>The second custom function will arrange a data frame to be assigned to “Name_Arrange” in a custom order. The <code>arrange()</code> and <code>match()</code> functions are used in this custom function to reorder the rows by one or more variable from the wanted column “Column_Of_Interest” which will be attributed to the object “Name_Taxonomy_Replace”.</p>
<pre class="r numberLines"><code>Function_Arrange &lt;- function(Name_Arrange, Column_Of_Interest ,Name_Taxonomy_Replace){
Name_Arrange %&gt;% 
  arrange(match(Column_Of_Interest, c(Name_Taxonomy_Replace)))
} </code></pre>
<p>The third custom function has for aim to create a data frame which can be use to create a Sunburt plot. In order to do so, we use the <code>data.frame()</code> function to create a dataframe with the different parameters needed for the construction of Sunburst plot.</p>
<p>The sunburst sectors are determined by the entries in “ids”, “labels” and “parents”. - ids: This will assign id labels to each datum. These ids will be used as an object constancy of the different data points during the sunburst animation. They should only be an array of strings. - labels: This will enable us to set the labels for each of the different sectors. - parents: This will set the parent sectors for each of the different created sectors. The use of empty string items ’’ will be understood as a way to reference the root node in the hierarchy. In this case, as the “ids” are filled, the “parents” items are understood to also be “ids” themselves. - size: This will attribute the size of each of the different sectors.</p>
<pre class="r numberLines"><code>Function_DataFrame_Sb &lt;- function(Data_Arrange_Taxonomy, Label_Order, Parent_Order, Data_Arrange_Total){
data.frame(
    ids = c(Data_Arrange_Taxonomy) ,
  labels = c(Label_Order),
  parents = c(Parent_Order),
  size = Data_Arrange_Total,
   stringsAsFactors = FALSE) 
}</code></pre>
<p>The fourth and final custom function will be used to create and allow the Sunburst plot to be interactive. In order to do so, we use the <code>plot_ly()</code> function. the hovertext is attributed the data we want to appear as we hover the different sectors of the sunburst plot.</p>
<pre class="r numberLines"><code>#This function will allow for the creation of the Sunburst Plot
Function_Sb &lt;- function(Sunburst_Dataset, Dataset_Arrange_Total){
plot_ly(Sunburst_Dataset, 
        ids = ~ids, 
        labels = ~labels, 
        parents = ~parents, 
        type = &#39;sunburst&#39;,
        hovertext = ~Dataset_Arrange_Total,
        marker = list(colors = manualcolorSb))
}</code></pre>

<p>Copyright &copy; 2020, Gilleard Lab's, All rights reserved.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
